@layout LoginLayout
@page "/auth/login"

@inject ITestService _testService
@inject IAuthenticationService _authenticationService
@inject NavigationManager _navigationManager

<EditForm Model="loginModel" OnValidSubmit="submitForm">
    <div class="input-group mb-2">
        <Syncfusion.Blazor.Inputs.SfTextBox @bind-Value="loginModel.Username" Placeholder="Username" FloatLabelType="@FloatLabelType.Auto"></Syncfusion.Blazor.Inputs.SfTextBox>
    </div>
    <div class="input-group mb-2">
        <Syncfusion.Blazor.Inputs.SfTextBox @bind-Value="loginModel.Password" Placeholder="Password" Type="InputType.Password" FloatLabelType="@FloatLabelType.Auto"></Syncfusion.Blazor.Inputs.SfTextBox>

    </div>
    <div class="row">

        <!-- /.col -->
        <div class="col-12">
            <SfProgressButton CssClass="sf-button-full-width" Content="Login"  Duration="99999" IsPrimary="true" Disabled="isLoading">
                <ProgressButtonSpinSettings Position="SpinPosition.Left" ></ProgressButtonSpinSettings>
                
            </SfProgressButton>
        </div>
    </div>
</EditForm>
@code {

    bool isLoading = false;
    private LoginModel loginModel = new LoginModel();
    private void SignIn()
    {
    }
        protected override void OnInitialized()
        {
          
            base.OnInitialized();
        }
        private class LoginModel
    {
        [Required(ErrorMessage = "Username is required")]
        public string Username { get; set; }
        [Required(ErrorMessage = "Password is required")]
        public string Password { get; set; }
    }

    private async Task submitForm()
    {
        isLoading = true;
        var loginResult = await _authenticationService.Login(loginModel.Username, loginModel.Password);
        if (loginResult.IsSuccess)
        {
            _navigationManager.NavigateTo("/");
        }
    }

}
